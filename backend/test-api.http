# API Testing File for Shopify Backend
# Use with VS Code REST Client extension or similar tools

### Variables
@baseUrl = http://localhost:4000
@testShop = your-test-shop.myshopify.com

### 1. Health Check
GET {{baseUrl}}/health
Content-Type: application/json

### 2. Google OAuth Flow (Manual Test)
# Visit this URL in browser to start OAuth flow
GET {{baseUrl}}/auth/google

### 3. Check Current User (requires valid session)
GET {{baseUrl}}/auth/current
Content-Type: application/json

### 4. Shopify Install Flow (Manual Test)
# Visit this URL in browser with your test shop
GET {{baseUrl}}/auth/shopify?shop={{testShop}}

### 5. Test Webhook Endpoint (simulate Shopify webhook)
POST {{baseUrl}}/webhooks/shopify
Content-Type: application/json
X-Shopify-Topic: orders/create
X-Shopify-Shop-Domain: {{testShop}}
X-Shopify-Hmac-Sha256: test-hmac-signature

{
  "id": 123456789,
  "name": "#1001",
  "email": "customer@example.com",
  "total_price": "199.99",
  "currency": "USD",
  "financial_status": "paid",
  "fulfillment_status": "unfulfilled",
  "created_at": "2024-01-15T10:30:00Z",
  "line_items": [
    {
      "id": 987654321,
      "product_id": 111222333,
      "title": "Test Product",
      "quantity": 2,
      "price": "99.99"
    }
  ]
}

### 6. Test Rate Limiting
# Make multiple requests quickly to test rate limiting
GET {{baseUrl}}/health
GET {{baseUrl}}/health
GET {{baseUrl}}/health

### 7. Test Error Handling - Invalid Endpoint
GET {{baseUrl}}/invalid-endpoint
Content-Type: application/json

### 8. Test CORS
OPTIONS {{baseUrl}}/health
Origin: http://localhost:3000
Access-Control-Request-Method: GET
Access-Control-Request-Headers: Content-Type